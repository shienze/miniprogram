<!-- pages/common/register.wxml -->
<view class="container">
  <view class="form-container">
    <text class="title">注册</text>
  
    <view class="role-section">
      <text class="section-title">选择您的角色</text>
      <radio-group class="role-group" bindchange="handleRoleChange">
        <label class="role-item">
          <radio value="user" checked="{{role === 'user'}}" /> 学生/求职者
        </label>
        <label class="role-item">
          <radio value="enterprise" checked="{{role === 'enterprise'}}" /> 企业/机构
        </label>
      </radio-group>
    </view>
    
    <button class="wx-btn" bindtap="handleWechatAuth">微信认证</button>

    <block wx:if="{{role === 'user'}}">
      <view class="field-label">姓名</view>
      <input class="input" placeholder="姓名" bindinput="inputName" value="{{name}}" />

      <view class="search-field">
        <view class="field-label">院校</view>
        <input 
          class="input search-input" 
          placeholder="搜索院校名称" 
          bindinput="onSchoolSearch"
          value="{{schoolKeyword}}"
        />

        <view class="selected-item" wx:if="{{school}}">
          <text class="selected-text">已选择: {{school}}</text>
          <text class="clear-btn" bindtap="clearSchool">×</text>
        </view>

        <view class="search-results" wx:if="{{showSchoolList && schoolKeyword && filteredSchools.length > 0}}">
          <scroll-view scroll-y style="max-height: 300rpx;">
            <block wx:for="{{filteredSchools}}" wx:key="*this">
              <view 
                class="result-item" 
                bindtap="selectSchool"
                data-school="{{item}}"
              >
                {{item}}
              </view>
            </block>
          </scroll-view>
        </view>
        <view class="no-results" wx:if="{{showSchoolList && schoolKeyword && filteredSchools.length === 0}}">
          未找到相关院校
        </view>
      </view>

      <view class="form-item">
  <view class="label">专业</view>
  
  <view class="sub-label">专业大类</view>
  <picker 
    range="{{majorCategories}}" 
    value="{{majorCategoryIndex}}"
    bindchange="onMajorCategoryChange"
  >
    <view class="picker">{{majorCategory || '请选择专业大类'}}</view>
  </picker>
  
  <view wx:if="{{majorCategory}}">
    <view class="sub-label">专业名称</view>
    <picker 
      range="{{currentMajorNames}}" 
      value="{{majorNameIndex}}"
      bindchange="onMajorNameChange"
    >
      <view class="picker">{{majorName || '请选择专业名称'}}</view>
    </picker>
  </view>
</view>

      

      <view class="picker-field">
        <view class="field-label">年级</view>
        <picker bindchange="changeGrade" range="{{gradeOptions}}" value="{{gradeIndex}}">
          <view class="picker">
            {{gradeOptions[gradeIndex]}}
          </view>
        </picker>
      </view>
    </block>
    
    <block wx:if="{{role === 'enterprise'}}">
      <input class="input" placeholder="企业名称" bindinput="inputCompany" value="{{company}}" />
      <input class="input" placeholder="联系人姓名" bindinput="inputContact" value="{{contact}}" />
      <input class="input" placeholder="企业邮箱" bindinput="inputEmail" value="{{email}}" />
    </block>
    
    <button class="submit-btn" bindtap="submitRegister">注册</button>
    
    <text class="login-link" bindtap="toLogin">已有账号？立即登录</text>
  </view>
  
  <view 
    class="mask" 
    wx:if="{{showSchoolList || showMajorCategoryList || showMajorNameList}}" 
    bindtap="hideAllLists"
  ></view>
  
  <loading hidden="{{!loading}}">注册中...</loading>
</view>